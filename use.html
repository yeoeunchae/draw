<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ë½‘ê¸° í˜ì´ì§€</title>
<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="usestyle.css">
<script>
 if ("serviceWorker" in navigator) {
   navigator.serviceWorker.register("/service-worker.js");
 }

  function openAdminModal() {
    document.getElementById("adminModal").style.display = "block";
  }

  function closeAdminModal() {
    document.getElementById("adminModal").style.display = "none";
    document.getElementById("adminPass").value = "";
  }

function checkPass() {
  const input = document.getElementById("adminPass").value;
  const realPassword = "1234"; // ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸

  if (input === realPassword) {
    alert("ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ìƒˆ íƒ­ìœ¼ë¡œ ì—½ë‹ˆë‹¤.");
    window.open("admin.html", "_blank"); // ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸°
    closeAdminModal(); // íŒì—… ë‹«ê¸°
  } else {
    alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!");
  }
}


  function loadItems() {
    return JSON.parse(localStorage.getItem("items") || "[]");
  }

  function saveItems(items) {
    localStorage.setItem("items", JSON.stringify(items));
  }

  function draw() {
    let items = loadItems();
    let pool = [];
    items.forEach(i => { for(let x=0;x<i.left;x++) pool.push(i); });
    let drawCount = parseInt(document.getElementById("count").value);
    if (isNaN(drawCount)||drawCount<1){ alert("ë½‘ì„ ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”."); return;}
    if (pool.length===0){document.getElementById("result").innerText="âŒ ë” ì´ìƒ ë‚¨ì€ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤."; return;}

    let available = pool.length;
    let finalCount = Math.min(drawCount, available);
    let results = [];
    for (let i=0;i<finalCount;i++){
      const picked = pool[Math.floor(Math.random()*pool.length)];
      results.push(picked.name);
      const target = items.find(it=>it.id===picked.id);
      target.left--;
      pool=[];
      items.forEach(it=>{ for(let x=0;x<it.left;x++) pool.push(it); });
    }
    saveItems(items);
    document.getElementById("result").innerText = results.map((r,idx)=>`${idx+1}. ${r}`).join("\n");
    updateLeft();
  }

  function updateLeft(){
    let items=loadItems();
    let total = items.reduce((a,b)=>a+b.left,0);
    document.getElementById("left").innerText = `ë‚¨ì€ ì „ì²´ ìˆ˜ëŸ‰: ${total}`;
  }

  window.onload = updateLeft;
</script>
</head>
<body>

<!-- ì‚¬ì´ë“œ ì„¤ì • ë²„íŠ¼ -->
<button onclick="openAdminModal()" style="position:fixed;top:20px;right:20px;width:auto;padding:10px 16px;font-size:16px;">ì„¤ì •</button>

<div class="box">
  <h2>ğŸ‰ ë½‘ê¸°</h2>
  <div class="draw-box">
    <input id="count" type="number" min="1" placeholder="ë½‘ì„ ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
    <button onclick="draw()">ë½‘ê¸°!</button>
  </div>

  <div class="result" id="result"></div>
  <div class="small" id="left"></div>
</div>

<!-- ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ -->
<div id="adminModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeAdminModal()">&times;</span>
    <h3>ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</h3>
    <input type="password" id="adminPass" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" />
    <button onclick="checkPass()">í™•ì¸</button>
  </div>
</div>

</body>
</html>




